<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap
        PUBLIC "-//iBATIS.apache.org//DTD SQL Map 2.0//EN"
        "http://iBATIS.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Account">
    <!-- 定义别名，使用时就可省略包名 -->
    <typeAlias alias="Account" type="com.study.ibatis.domain.Account"/>

    <!-- SQL字段与类属性映射关系，省略在SQL语句中用as转换字段别名 -->
    <resultMap id="AccountResult" class="Account">
        <result property="id" column="ACC_ID"/>
        <result property="firstName" column="ACC_FIRST_NAME"/>
        <result property="lastName" column="ACC_LAST_NAME"/>
        <result property="emailAddress" column="ACC_EMAIL"/>
    </resultMap>

    <!-- SQL字段类型与类属性映射关系，在SQL语句中用?占位符就可以了 -->
    <parameterMap id="AccountParameter" class="Account">
        <parameter property="id" jdbcType="INT"/>
        <parameter property="firstName" jdbcType="VARCHAR"/>
        <parameter property="lastName" jdbcType="VARCHAR"/>
        <parameter property="emailAddress" jdbcType="VARCHAR"/>
    </parameterMap>

    <!-- 模糊查询时用$号 -->
    <select id="select" resultMap="AccountResult" parameterClass="String">
        select * from ACCOUNT
        where ACC_FIRST_NAME like '%$name$%'
    </select>
    <select id="selectAllAccounts" resultMap="AccountResult">
        select * from ACCOUNT
    </select>
    <!-- #号做通配符，相当于JDBC中的?号 -->
    <select id="selectAccountById" parameterClass="int" resultClass="Account">
        select
        ACC_ID as id,
        ACC_FIRST_NAME as firstName,
        ACC_LAST_NAME as lastName,
        ACC_EMAIL as emailAddress
        from ACCOUNT
        where ACC_ID = #id#
    </select>


    <!-- 使用外联参数映射是用？占位符 -->
    <insert id="insert" parameterClass="Account">
        insert into ACCOUNT (ACC_ID, ACC_FIRST_NAME, ACC_LAST_NAME, ACC_EMAIL)
        values (#id#, #firstName#, #lastName#, #emailAddress#)
    </insert>

    <!-- 插入语句返回值要通过selectKey查询 -->
    <insert id="insertAccount2" parameterClass="Account">
        insert into ACCOUNT (ACC_ID, ACC_FIRST_NAME, ACC_LAST_NAME, ACC_EMAIL)
        values (#id#, #firstName#, #lastName#, #emailAddress#)
        <selectKey>
            select @@IDENTITY
        </selectKey>
    </insert>
    <!-- 更新语句返回受影响行数 -->
    <update id="updateAccount" parameterClass="Account">
        update ACCOUNT set
        ACC_FIRST_NAME = #firstName#,
        ACC_LAST_NAME = #lastName#,
        ACC_EMAIL = #emailAddress#
        where
        ACC_ID = #id#
    </update>
    <!-- 删除语句返回受影响行数 -->
    <delete id="deleteAccountById" parameterClass="int">
        delete from ACCOUNT where ACC_ID = #id#
    </delete>
</sqlMap>